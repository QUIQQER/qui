define("qui/classes/utils/DragDrop",["qui/classes/DOM"],function(DOM){"use strict";return new Class({Extends:DOM,Type:"qui/classes/utils/DragDrop",Binds:["$complete","$onDrag","$onDrop","$onLeave","$onEnter"],options:{dropables:[document.body],styles:false,cssClass:false,delay:250,limit:{x:false,y:false}},initialize:function(Elm,options){this.parent(options);this.$Drag=null;this.$Element=Elm;this.$enable=true;Elm.addEvents({mousedown:function(event){if(!this.$enable){return}this.setAttribute("_stopdrag",false);this.$timer=this.$start.delay(this.getAttribute("delay"),this,event);event.stop()}.bind(this),mouseup:function(event){if(typeof this.$timer!=="undefined"){clearTimeout(this.$timer)}this.$stop(event)}.bind(this)})},getElm:function(){return this.$Elm},enable:function(){this.$enable=true},disable:function(){this.$enable=false},$start:function(event){if(!this.$enable){return}if(event.rightClick){return}if(Browser.ie8){return}if(this.getAttribute("_mousedown")){return}if(this.getAttribute("_stopdrag")){return}this.setAttribute("_mousedown",true);var i,len;var mx=event.page.x,my=event.page.y,Elm=this.$Element,ElmSize=Elm.getSize(),limit=this.getAttribute("limit"),docsize=document.body.getSize();this.$Drag=new Element("div",{"class":"box",styles:{position:"absolute",top:my-20,left:mx-40,zIndex:1e3,MozOutline:"none",outline:0,color:"#fff",padding:10,cursor:"pointer",width:ElmSize.x,height:ElmSize.y,background:"rgba(0,0,0, 0.5)"}}).inject(document.body);if(this.getAttribute("styles")){this.$Drag.setStyles(this.getAttribute("styles"))}if(this.getAttribute("cssClass")){this.$Drag.addClass(this.getAttribute("cssClass"))}this.$Drag.focus();this.fireEvent("start",[this,this.$Drag,event]);if(!limit.x){limit.x=[0,docsize.x-this.$Drag.getSize().x]}if(!limit.y){limit.y=[0,docsize.y-this.$Drag.getSize().y]}var dropables=this.getAttribute("dropables");if(typeOf(dropables)==="array"){dropables=dropables.join(",")}new Drag.Move(this.$Drag,{precalculate:true,droppables:dropables,onComplete:this.$complete,onDrop:this.$onDrop,onEnter:this.$onEnter,onLeave:this.$onLeave,onDrag:this.$onDrag,limit:limit}).start({page:{x:mx,y:my}})},$stop:function(){if(Browser.ie8){return}if(!this.getAttribute("_mousedown")){this.setAttribute("_stopdrag",true);return}this.setAttribute("_mousedown",false);if(typeof this.$Drag!=="undefined"||this.$Drag){this.fireEvent("stop",[this,this.$Drag]);this.$Drag.destroy();this.$Drag=null}},$complete:function(event){this.fireEvent("complete",[this,event]);this.$stop()},$onDrag:function(Element,event){this.fireEvent("drag",[this,Element,event])},$onDrop:function(Element,Dropable,event){this.fireEvent("drop",[this,Element,Dropable,event])},$onEnter:function(Element,Dropable){this.fireEvent("enter",[this,Element,Dropable])},$onLeave:function(Element,Dropable){this.fireEvent("leave",[this,Element,Dropable])}})});
//# sourceMappingURL=/var/www/git/quiqqer/qui/build/qui/classes/utils/DragDrop.map.js