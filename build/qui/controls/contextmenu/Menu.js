define("qui/controls/contextmenu/Menu",["qui/controls/Control","qui/controls/contextmenu/Item","qui/controls/contextmenu/Seperator","css!qui/controls/contextmenu/Menu.css"],function(Control,ContextMenuItem,ContextMenuSeperator){"use strict";return new Class({Extends:Control,Type:"qui/controls/contextmenu/Menu",Binds:["$keyup"],options:{styles:null,width:200,title:false,shadow:true,dragable:false},initialize:function(options){this.parent(options);this.$items=[];this.$Title=null;this.$Active=null},create:function(){this.$Elm=new Element("div.qui-contextmenu",{tabindex:-1,styles:{display:"none",outline:"none","-moz-outline":"none"},events:{blur:function(){this.fireEvent("blur",[this])}.bind(this),keyup:this.$keyup},"data-quiid":this.getId()});if(this.getAttribute("width")){this.$Elm.setStyle("width",this.getAttribute("width"))}if(this.getAttribute("styles")){this.$Elm.setStyles(this.getAttribute("styles"))}if(this.getAttribute("title")){this.setTitle(this.getAttribute("title"))}if(this.getAttribute("shadow")){this.$Elm.addClass("qui-contextmenu-shadow")}for(var i=0,len=this.$items.length;i<len;i++){this.$items[i].inject(this.$Elm)}return this.$Elm},show:function(){if(!this.$Elm){return this}var Parent=this.$Elm.getParent(),Elm=this.$Elm;Elm.setStyle("display","");this.setAttribute("menuPosLeft",false);if(Parent.nodeName==="BODY"){var elm_size=Elm.getSize(),elm_pos=Elm.getPosition(),body_size=Parent.getSize();if(elm_pos.x+elm_size.x>body_size.x){this.$Elm.setStyle("left",body_size.x-elm_size.x-10)}if(elm_pos.y+elm_size.y>body_size.y){this.$Elm.setStyle("top",body_size.y-elm_size.y-10)}}if(this.$Active){this.$Active.setActive()}this.fireEvent("show",[this]);return this},hide:function(){this.getElm().setStyle("display","none");this.fireEvent("hide",[this]);return this},focus:function(){this.getElm().focus();this.fireEvent("focus",[this]);return this},setPosition:function(x,y){if(this.$Elm){this.$Elm.setStyles({left:x,top:y})}return this},setTitle:function(text){if(this.$Elm&&!this.$Title){this.$Title=new Element("div.qui-contextmenu-title");this.$Title.inject(this.$Elm,"top")}if(this.$Title){this.$Title.set("html",text)}this.setAttribute("title",text);return this},getChildren:function(name){if(typeof name!=="undefined"){var i,len;var items=this.$items;for(i=0,len=items.length;i<len;i++){if(items[i].getAttribute("name")==name){return items[i]}}return false}return this.$items},firstChild:function(){if(this.$items[0]){return this.$items[0]}return false},count:function(){return this.$items.length},appendChild:function(Child){if(!Child||typeof Child==="undefined"){return this}this.$items.push(Child);Child.setParent(this);if(this.getAttribute("dragable")){Child.setAttribute("dragable",true)}Child.addEvent("onClick",function(Item,event){this.hide();document.body.focus();if(typeof event!=="undefined"){event.stop()}}.bind(this));Child.addEvent("onActive",function(Item){if(this.$Active==Item){return}if(this.$Active){this.$Active.setNormal()}this.$Active=Item}.bind(this));if(this.$Elm){Child.inject(this.$Elm)}return this},clearChildren:function(){for(var i=0,len=this.$items.length;i<len;i++){if(this.$items[i]){this.$items[i].destroy()}}this.$items=[];return this},getActive:function(){return this.$Active?this.$Active:false},getNext:function(Item){for(var i=0,len=this.$items.length;i<len;i++){if(this.$items[i]!=Item){continue}if(typeof this.$items[i+1]!=="undefined"){return this.$items[i+1]}}return false},getPrevious:function(Item){var i=this.$items.length-1;for(;i>=0;i--){if(i===0){return false}if(this.$items[i]==Item){return this.$items[i-1]}}return false},deselectItems:function(){if(this.$Active){this.$Active=null}return this},$keyup:function(event){if(event.key==="down"){this.down();return}if(event.key==="up"){this.up(event);return}if(event.key==="enter"){this.select(event);return}},up:function(event){if(!this.$items.length){return}var len=this.$items.length;if(!this.$Active){this.$items[len-1].setActive();return}var Prev=this.getPrevious(this.$Active);this.$Active.setNormal();if(!Prev){this.$items[len-1].setActive();return}Prev.setActive()},down:function(){if(!this.$items.length){return}if(!this.$Active){this.$items[0].setActive();return}var Next=this.getNext(this.$Active);this.$Active.setNormal();if(!Next){this.$items[0].setActive();return}Next.setActive()},select:function(event){if(this.$Active){this.$Active.fireEvent("mouseDown",[this.$Active,event]);this.$Active.fireEvent("click",[this.$Active,event])}}})});
//# sourceMappingURL=/var/www/git/quiqqer/qui/build/qui/controls/contextmenu/Menu.map.js