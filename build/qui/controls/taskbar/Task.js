define("qui/controls/taskbar/Task",["qui/QUI","qui/controls/Control","qui/classes/utils/DragDrop","qui/utils/Controls","css!qui/controls/taskbar/Task.css"],function(QUI,Control,QUIDragDrop,Utils){"use strict";return new Class({Extends:Control,Type:"qui/controls/taskbar/Task",Binds:["close","click","$onDestroy"],options:{name:"qui-task",icon:false,text:"",cssClass:"",closeable:true,dragable:true},initialize:function(Instance,options){this.$Instance=Instance||null;this.$Elm=null;this.addEvents({onDestroy:this.$onDestroy});if(typeof Instance==="undefined"){return}Instance.setAttribute("Task",this);Instance.addEvent("onRefresh",function(Instance){Instance.getAttribute("Task").refresh()});Instance.addEvent("onDestroy",function(Instance){var Task=Instance.getAttribute("Task");Task.$Instance=null;Task.destroy()});this.parent(options)},serialize:function(){return{attributes:this.getAttributes(),type:this.getType(),instance:this.getInstance()?this.getInstance().serialize():""}},unserialize:function(data,onfinish){this.setAttributes(data.attributes);var instance=data.instance;if(!instance){return this}QUI.Controls.getByType(instance.type,function(Modul){var Instance=new Modul(data.instance);Instance.unserialize(data.instance);this.initialize(Instance,data.attributes)}.bind(this))},create:function(){if(this.$Elm){return this.$Elm}var self=this;this.$Elm=new Element("div",{"class":"qui-task radius5 box",html:'<span class="qui-task-icon"></span>'+'<span class="qui-task-text"></span>',styles:{outline:"none"},tabindex:-1,events:{click:self.click,focus:function(event){self.fireEvent("focus",[self,event])},blur:function(event){self.fireEvent("blur",[self,event])},contextmenu:function(event){self.fireEvent("contextMenu",[self,event]);event.stop()}}});if(this.getAttribute("dragable")){this.$_enter=null;new QUIDragDrop(this.$Elm,{dropables:[".qui-taskgroup",".qui-taskbar"],cssClass:"radius5",events:{onEnter:function(Element,Droppable){if(!Droppable){return}var quiid=Droppable.get("data-quiid");if(!quiid){return}QUI.Controls.getById(quiid).highlight()},onLeave:function(Element,Droppable){if(!Droppable){return}var quiid=Droppable.get("data-quiid");if(!quiid){return}QUI.Controls.getById(quiid).normalize()},onDrop:function(Element,Droppable,event){if(!Droppable){return}var quiid=Droppable.get("data-quiid");if(!quiid){return}var Bar=QUI.Controls.getById(quiid);Bar.normalize();Bar.appendChild(self)}}})}if(this.getAttribute("cssClass")){this.$Elm.addClass(this.getAttribute("cssClass"))}if(this.getAttribute("closeable")){new Element("div",{"class":"qui-task-close",html:'<span class="icon-remove"></span>',events:{click:this.close}}).inject(this.$Elm)}if(typeof this.$serialize!=="undefined"){this.unserialize(this.$serialize)}this.refresh();return this.$Elm},refresh:function(){if(!this.$Elm){this.fireEvent("refresh",[this]);return}var Icon=this.$Elm.getElement(".qui-task-icon"),Text=this.$Elm.getElement(".qui-task-text");if(this.getIcon()){var icon=this.getIcon();Icon.className="qui-task-icon";Icon.setStyle("background-image",null);if(Utils.isFontAwesomeClass(icon)){Icon.addClass(icon)}else{Icon.setStyle("background-image","url("+icon+")")}}if(this.getTitle()){var title=this.getTitle();title=title.substring(0,19);if(title.length>19){title=title+"..."}Text.set("html",title)}this.fireEvent("refresh",[this])},getIcon:function(){if(!this.getInstance()){return""}return this.getInstance().getAttribute("icon")},getTitle:function(){if(!this.getInstance()){return""}return this.getInstance().getAttribute("title")},getInstance:function(){return this.$Instance},setInstance:function(Instance){this.$Instance=Instance},getTaskbar:function(){var Taskbar=this.getParent();if(typeOf(Taskbar)=="qui/controls/taskbar/Group"){Taskbar=Taskbar.getParent()}return Taskbar},activate:function(){if(this.isActive()||!this.$Elm){return this}this.$Elm.addClass("active");this.fireEvent("activate",[this]);return this},normalize:function(){if(this.$Elm){this.$Elm.removeClass("active");this.$Elm.removeClass("highlight");this.$Elm.removeClass("select");this.$Elm.setStyle("display",null)}this.fireEvent("normalize",[this]);return this},hide:function(){if(this.$Elm){this.$Elm.setStyle("display","none")}return this},isActive:function(){if(!this.$Elm){return false}return this.$Elm.hasClass("active")},click:function(event){this.fireEvent("click",[this,event]);if(!this.isActive()){this.activate()}return this},close:function(event){this.fireEvent("close",[this,event]);this.destroy();return this},focus:function(){if(this.$Elm){this.$Elm.focus()}return this},highlight:function(){if(this.$Elm){this.$Elm.addClass("highlight")}this.fireEvent("highlight",[this]);return this},select:function(){if(this.$Elm){this.$Elm.addClass("select")}this.fireEvent("select",[this]);return this},isSelected:function(){if(this.$Elm){return this.$Elm.hasClass("select")}return false},unselect:function(){if(this.$Elm){this.$Elm.removeClass("select")}this.fireEvent("unselect",[this]);return this},$onDestroy:function(){if(this.getInstance()){this.getInstance().destroy()}this.$Instance=null}})});
//# sourceMappingURL=/var/www/git/quiqqer/qui/build/qui/controls/taskbar/Task.map.js