define("qui/controls/toolbar/Bar",["qui/controls/Control","qui/controls/contextmenu/Menu","qui/controls/contextmenu/Item","qui/controls/buttons/Button","qui/lib/moofx","css!qui/controls/toolbar/Bar.css"],function(Control,ContextMenu,ContextMenuItem,Button){"use strict";return new Class({Extends:Control,Type:"qui/controls/toolbar/Bar",options:{"menu-button":true,slide:true,width:false,type:"tabbar"},initialize:function(options){this.Fx=null;this.$Elm=null;this.Tabs=null;this.Menu=null;this.Container=null;this.Active=null;this.BtnLeft=null;this.BtnRight=null;this.items=[];this.btns=[];this.parent(options)},destroy:function(){var i,len;for(i=0,len=this.items.length;i<len;i++){this.items[i].destroy()}for(i=0,len=this.btns.length;i<len;i++){this.btns[i].destroy()}this.items=[];this.btns=[];if(this.$Elm){this.$Elm.destroy()}if(this.BtnLeft){this.BtnLeft.destroy()}if(this.BtnRight){this.BtnRight.destroy()}if(this.Menu){this.Menu.destroy()}this.Fx=null;this.$Elm=null;this.Tabs=null;this.Menu=null;this.Container=null;this.Active=null;this.BtnLeft=null;this.BtnRight=null},refresh:function(){if(!this.$Elm){return this}var i,len,Itm;var items=this.items,width=0;this.Tabs.set("html","");for(i=0,len=items.length;i<len;i++){Itm=items[i];Itm.inject(this.Tabs);this.Menu.appendChild(this.$addContextMenuItm(Itm))}if(this.getAttribute("menu-button")===true){this.Menu.show()}else{this.Menu.hide()}if(this.getAttribute("slide")===true){this.BtnLeft.show();this.BtnRight.show()}else{this.BtnLeft.hide();this.BtnRight.hide()}this.resize();return this},create:function(){if(this.$Elm){this.refresh();return this.$Elm}this.$Elm=new Element("div",{"class":"qui-toolbar","data-quiid":this.getId(),html:'<div class="qui-toolbar-container">'+'<div class="qui-toolbar-tabs"></div>'+"</div>"});if(this.getAttribute("styles")){this.$Elm.setStyles(this.getAttribute("styles"))}this.Tabs=this.$Elm.getElement(".qui-toolbar-tabs");this.Container=this.$Elm.getElement(".qui-toolbar-container");var items=this.items,width=0;this.BtnLeft=new Button({name:"toLeft","class":"qui-toolbar-button icon-chevron-left",events:{onClick:function(Btn){Btn.getAttribute("Toolbar").toLeft()}},Toolbar:this});this.BtnRight=new Button({name:"toRight","class":"qui-toolbar-button icon-chevron-right",events:{onClick:function(Btn){Btn.getAttribute("Toolbar").toRight()}},Toolbar:this});this.Menu=new Button({"class":"qui-toolbar-button icon-chevron-down"});this.Menu.setParent(this);this.Menu.inject(this.$Elm,"top");this.BtnLeft.inject(this.$Elm,"top");this.BtnRight.inject(this.$Elm);this.Tabs.setStyles({position:"relative",left:0,"float":"left"});this.refresh();this.Fx=moofx(this.Tabs);return this.$Elm},clear:function(){if(!this.Tabs){this.fireEvent("clear",[this]);return this}var i,len;for(i=0,len=this.items.length;i<len;i++){this.items[i].destroy()}for(i=0,len=this.btns.length;i<len;i++){this.btns[i].destroy()}this.Tabs.set("html","");delete this.items;delete this.Active;this.items=[];this.btns=[];this.Active=null;if(this.Menu){this.Menu.clear();this.Menu.setDisable()}if(this.moveLeft){this.moveLeft.setDisable()}if(this.moveRight){this.moveRight.setDisable()}this.Tabs.setStyle("left",0);this.fireEvent("clear",[this]);return this},hide:function(){this.$Elm.setStyles({height:0,overflow:"hidden"});return this},show:function(){this.$Elm.setStyle("height",null);this.$Elm.setStyle("overflow",null);return this},toLeft:function(){if(!this.Fx){return}this.Fx.animate({left:0});return this},toRight:function(){var left=this.Tabs.offsetLeft-150;if(left<(this.Tabs.offsetWidth-150)*-1){left=0}this.Fx.animate({left:left});return this},toTab:function(Tab){if(this.getAttribute("slide")===false){return this}if(!this.$Elm){return this}if(Tab==this.firstChild()){this.Fx.animate({left:0});return this}var needle;var TabElm=Tab.getElm(),Container=this.$Elm.getElement(".qui-toolbar-container"),Tabs=this.$Elm.getElement(".qui-toolbar-tabs"),left=Tabs.getStyle("left").toInt()+Tab.getElm().offsetLeft,pos=Tab.getElm().offsetLeft+Tab.getElm().offsetWidth;if(left<0){this.Fx.animate({left:Tabs.getStyle("left").toInt()+left*-1+20});return this}if(pos>Container.offsetWidth){needle=pos-Container.offsetWidth;this.Fx.animate({left:(needle+20)*-1});return this}return this},firstChild:function(){return this.items[0]},lastChild:function(){return this.items[this.items.length-1]},getChildren:function(name){if(typeof name!=="undefined"){return this.getElement(name)}return this.items},count:function(){return this.items.length},removeChild:function(Child){var i,len;var nitms=[],itms=this.items,childname=Child.getAttribute("name");for(i=0,len=itms.length;i<len;i++){if(itms[i].getAttribute("name")!=childname){nitms.push(itms[i]);continue}itms[i].destroy()}this.items=nitms;return this},moveChildToPos:function(Child,pos){var Before=false,nitems=[],itms=this.items;for(var i=0,len=itms.length;i<len;i++){if(Child==itms[i]){itms[i].destroy();continue}nitems.push(itms[i])}nitems.splice(pos-1,0,Child);if(pos-2>=0){nitems[pos-2].getElm().inject(Child.create(),"after")}this.items=nitems;return this},getElement:function(name){var i,len;var items=this.items;for(i=0,len=items.length;i<len;i++){if(items[i]&&items[i].getAttribute("name")==name){return items[i]}}return null},appendChild:function(Itm){if(typeof Itm==="undefined"){return this}var self=this,type=Itm.getType();switch(type){case"qui/controls/buttons/Button":case"qui/controls/buttons/Select":case"qui/controls/buttons/Seperator":case"qui/controls/toolbar/Tab":break;default:return this}Itm.setParent(this);if(type=="qui/controls/toolbar/Tab"){Itm.addEvent("click",function(Item){self.toTab(Item)})}this.fireEvent("appendChild",[this,Itm]);if(this.getAttribute("type")==="tabbar"&&Itm.getType()==="qui/controls/buttons/Button"){this.btns.push(Itm);Itm.inject(this.BtnRight.getElm(),"before");var Con=this.Container,Btn=Itm.getElm();Con.setStyle("width",Con.getStyle("width").toInt()-Btn.getSize().x);return this}this.items.push(Itm);if(!this.$Elm){return this}Itm.inject(this.Tabs);if(this.Menu){this.Menu.appendChild(this.$addContextMenuItm(Itm))}this.resize();if(this.Menu){this.Menu.setEnable()}if(this.BtnLeft){this.BtnLeft.setEnable()}if(this.BtnRight){this.BtnRight.setEnable()}return this},setItemActive:function(Child){if(this.Active){this.Active.leave();this.Active.setNormal();if(this.Active.getAttribute("ContextMenuItem")){this.Active.getAttribute("ContextMenuItem").getElm().setStyle("fontWeight","")}}this.Active=Child;this.Active.setActive();if(this.Active.getAttribute("ContextMenuItem")){this.Active.getAttribute("ContextMenuItem").getElm().setStyle("fontWeight","bold")}return this},getActive:function(){return this.Active},resize:function(){var i,len;var width=0,cwidth=0,itms=this.Tabs.getChildren();for(i=0,len=itms.length;i<len;i++){width=width+itms[i].getSize().x.toInt()+30}if(this.getAttribute("width")&&this.getAttribute("width").toString().contains("%")===false){cwidth=this.getAttribute("width").toInt();if(this.getAttribute("slide")){cwidth=cwidth-this.BtnLeft.getElm().getComputedSize().totalWidth-this.BtnRight.getElm().getComputedSize().totalWidth}if(this.getAttribute("menu-button")){cwidth=cwidth-this.Menu.getElm().getComputedSize().totalWidth}}else{cwidth="100%"}this.Tabs.setStyle("width",width);this.Container.setStyle("width",cwidth);this.getElm().setStyle("width",this.getAttribute("width"));return this},$addContextMenuItm:function(Itm){var MenuItem=new ContextMenuItem(Itm.getAttributes());MenuItem.setAttribute("TAB",Itm);MenuItem.setAttribute("Toolbar",this);Itm.setAttribute("ContextMenuItem",MenuItem);MenuItem.addEvent("onMouseDown",function(Itm,event){var Tab=Itm.getAttribute("TAB"),Toolbar=Itm.getAttribute("Toolbar");Tab.click();Toolbar.toTab(Tab)});return MenuItem}})});
//# sourceMappingURL=/var/www/git/quiqqer/qui/build/qui/controls/toolbar/Bar.map.js