define("qui/controls/sitemap/Map",["qui/QUI","qui/controls/Control","qui/controls/sitemap/Item","css!qui/controls/sitemap/Map.css"],function(QUI,Control,Item){"use strict";return new Class({Extends:Control,Type:"qui/controls/sitemap/Map",options:{multible:false},initialize:function(options){var self=this;self.parent(options);self.$items=[];self.$sels={};self.addEvent("onAppendChild",function(Parent,Child){Child.addEvents({onClick:function(Item,event){self.fireEvent("childClick",[Item,self])},onSelect:function(Item,event){if(self.getAttribute("multible")===false||typeof event==="undefined"||self.getAttribute("multible")&&!event.control){self.deselectAllChildren()}self.$addSelected(Item)}})});self.addEvent("onDestroy",function(){self.clearChildren()})},create:function(){this.$Elm=new Element("div.qui-sitemap-map",{"data-quiid":this.getId()});for(var i=0,len=this.$items.length;i<len;i++){this.$items[i].inject(this.$Elm)}return this.$Elm},firstChild:function(){return this.$items[0]||false},appendChild:function(Itm){Itm.setParent(this);Itm.setMap(this);this.$items.push(Itm);if(this.$Elm){Itm.inject(this.$Elm)}this.fireEvent("appendChild",[this,Itm]);return this},clearChildren:function(){for(var i=0,len=this.$items.length;i<len;i++){this.$clearItem(this.$items[i])}this.$items=[];return this},getSelectedChildren:function(){var i;var result=[];for(i in this.$sels){result.push(this.$sels[i])}return result},getChildren:function(selector){selector=selector||".qui-sitemap-entry";var i,len,quiid,Child;var children=this.$Elm.getElements(selector),result=[],Controls=QUI.Controls;if(!children.length){return result}for(i=0,len=children.length;i<len;i++){quiid=children[i].get("data-quiid");Child=Controls.getById(quiid);if(Child){result.push(Child)}}return result},getElements:function(selector){return this.getChildren(selector)},getChildrenByValue:function(value){return this.getChildren('[data-value="'+value+'"]')},deselectAllChildren:function(){for(var i in this.$sels){this.$sels[i].deselect()}this.$sels={};return this},childContextMenu:function(Itm,event){if(typeof Itm==="undefined"){return this}this.fireEvent("childContextMenu",[this,Itm,event]);return this},openAll:function(){for(var i=0,len=this.$items.length;i<len;i++){this.$openItem(this.$items[i])}return this},$clearItem:function(Item){if(Item.hasChildren()===false){Item.destroy();return this}var i,len;var children=Item.getChildren();for(i=0,len=children.length;i<len;i++){this.$clearItem(children[i])}Item.clearChildren();Item.destroy();return this},$openItem:function(Item){Item.open();if(Item.hasChildren()===false){return this}var i,len;var children=Item.getChildren();for(i=0,len=children.length;i<len;i++){if(children[i].hasChildren()){this.$openItem(children[i])}}return this},$removeChild:function(Child){var items=[];for(var i=0,len=this.$items.length;i<len;i++){if(this.$items[i].getId()!==Child.getId()){items.push(this.$items[i])}}this.$items=items;return this},$addSelected:function(Item){this.$sels[Item.getId()]=Item;return this},$removeSelected:function(Item){if(this.$sels[Item.getId()]){this.$sels[Item.getId()].deselect();delete this.$sels[Item.getId()]}return this},search:function(search){search=search||"";var i,len,qid,Item,Node;var list=this.$Elm.getElements(".qui-sitemap-entry-text"),result=[],Controls=QUI.Controls,regex=new RegExp(search,"gi");for(i=0,len=list.length;i<len;i++){Node=list[i];if(Node.get("text").match(regex)){qid=Node.getParent(".qui-sitemap-entry").get("data-quiid");Item=Controls.getById(qid);if(Item){result.push(Item)}}}return result}})});
//# sourceMappingURL=/var/www/git/quiqqer/qui/build/qui/controls/sitemap/Map.map.js