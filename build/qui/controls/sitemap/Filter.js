define("qui/controls/sitemap/Filter",["qui/controls/Control","qui/controls/buttons/Button","css!qui/controls/sitemap/Filter.css"],function(Control,Button){"use strict";return new Class({Extends:Control,Type:"qui/controls/sitemap/Filter",Binds:["filter","$filter"],options:{styles:false,placeholder:"Filter ...",withbutton:false},initialize:function(Sitemap,options){this.parent(options);this.$Elm=null;this.$Input=null;this.$maps=[];this.bindSitemap(Sitemap);this.$timeoutID=false},create:function(){var self=this;this.$Elm=new Element("div",{"class":"qui-sitemap-filter box",html:'<input type="text" placeholder="'+this.getAttribute("placeholder")+'" />'});this.$Input=this.$Elm.getElement("input");this.$Input.addEvents({keyup:function(event){if(event.key=="enter"){self.filter(self.getInput().value);return}if(self.$timeoutID){clearTimeout(self.$timeoutID)}self.$timeoutID=function(){self.filter(self.getInput().value);self.$timeoutID=false}.delay(250)},focus:function(event){self.fireEvent("focus",[self])},blur:function(){if(self.getInput().value===""){self.filter()}}});if(this.getAttribute("withbutton")){this.$Search=new Button({image:URL_BIN_DIR+"16x16/search.png",events:{onClick:function(){self.filter(self.getInput().value)}}}).inject(this.$Elm)}if(this.getAttribute("styles")){this.$Elm.setStyles(this.getAttribute("styles"))}return this.$Elm},bindSitemap:function(Sitemap){if(typeof Sitemap==="undefined"||!Sitemap){return}this.$maps.push(Sitemap);return this},clearBinds:function(){this.$maps=[];return this},getInput:function(){return this.$Input},filter:function(str){str=str||"";for(var i=0,len=this.$maps.length;i<len;i++){this.$filter(this.$maps[i],str)}return this},$filter:function(Map,str){if(typeof Map==="undefined"||!Map){return}var i,len;var children=Map.getChildren();if(str===""){for(i=0,len=children.length;i<len;i++){children[i].normalize()}this.fireEvent("filter",[this,[]]);return}for(i=0,len=children.length;i<len;i++){children[i].holdBack()}var result=Map.search(str);for(i=0,len=result.length;i<len;i++){result[i].normalize()}this.fireEvent("filter",[this,result])}})});
//# sourceMappingURL=/var/www/git/quiqqer/qui/build/qui/controls/sitemap/Filter.map.js