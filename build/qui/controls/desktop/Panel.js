define("qui/controls/desktop/Panel",["qui/QUI","qui/controls/Control","qui/controls/loader/Loader","qui/controls/toolbar/Bar","qui/controls/buttons/Seperator","qui/controls/buttons/Button","qui/controls/desktop/panels/Sheet","qui/controls/breadcrumb/Bar","qui/utils/Controls","css!qui/controls/desktop/Panel.css"],function(QUI,Control,Loader,Toolbar,Seperator,Button,PanelSheet,BreadcrumbBar,Utils){"use strict";return new Class({Extends:Control,Type:"qui/controls/desktop/Panel",Binds:["$onDestroy","$onSetAttribute"],options:{name:"qui-desktop-panel",content:false,header:true,title:false,icon:false,footer:false,height:"100%","class":"",scrollbars:true,collapsible:true,collapseFooter:true,closeable:true,dragable:true,breadcrumb:false,toWindow:false},initialize:function(options){this.$uid=String.uniqueID();this.parent(options);this.Loader=new Loader;this.$Elm=null;this.$Header=null;this.$Title=null;this.$Footer=null;this.$Content=null;this.$Buttons=null;this.$Categories=null;this.$Breadcrumb=null;this.$ContextMenu=null;this.$ButtonBar=null;this.$CategoryBar=null;this.$BreadcrumbBar=null;this.$ActiveCat=null;this.$Dropable=null;this.addEvents({onDestroy:this.$onDestroy,onSetAttribute:this.$onSetAttribute})},create:function(){if(this.$Elm){return this.$Elm}var self=this;this.$Elm=new Element("div",{"data-quiid":this.getId(),"class":"qui-panel box",styles:{height:this.getAttribute("height")},html:'<div class="qui-panel-header box"></div>'+'<div class="qui-panel-buttons box"></div>'+'<div class="qui-panel-categories box"></div>'+'<div class="qui-panel-content box"></div>'+'<div class="qui-panel-footer box"></div>'});this.Loader.inject(this.$Elm);this.$Header=this.$Elm.getElement(".qui-panel-header");this.$Footer=this.$Elm.getElement(".qui-panel-footer");this.$Content=this.$Elm.getElement(".qui-panel-content");this.$Buttons=this.$Elm.getElement(".qui-panel-buttons");this.$Categories=this.$Elm.getElement(".qui-panel-categories");if(this.getAttribute("breadcrumb")){this.$Breadcrumb=new Element("div",{"class":"qui-panel-breadcrumb box"}).inject(this.$Buttons,"after")}if(this.getAttribute("styles")){this.$Elm.setStyles(this.getAttribute("styles"))}this.$Content.setStyle("display",null);this.$Buttons.setStyle("display","none");this.$Categories.setStyle("display","none");if(this.getAttribute("content")){this.$Content.set("html",this.getAttribute("content"))}if(this.getAttribute("collapsible")){this.$Collaps=new Element("div",{"class":"qui-panel-collapse icon-chevron-down"}).inject(this.$Header);this.$Header.setStyle("cursor","pointer");this.$Header.addEvent("click",function(){self.toggle()})}if(this.getAttribute("dragable")){this.$Header.setStyle("cursor","move")}this.$refresh();this.fireEvent("create",[this]);return this.$Elm},refresh:function(){this.resize();this.fireEvent("refresh",[this]);this.$refresh();return this},$refresh:function(){if(!this.$Title){this.$Icon=new Element("span.qui-panel-icon").inject(this.$Header);this.$Title=new Element("h2.qui-panel-title").inject(this.$Header)}if(this.getAttribute("title")){this.$Title.set("html",this.getAttribute("title"))}if(this.getAttribute("icon")){var path=this.getAttribute("icon");if(Utils.isFontAwesomeClass(path)){this.$Icon.addClass(path)}else{new Element("img",{src:path}).inject(this.$Icon)}}},resize:function(){if(this.getAttribute("header")===false){this.$Header.setStyle("display","none")}else{this.$Header.setStyle("display",null)}if(this.getAttribute("footer")===false){this.$Footer.setStyle("display","none")}else{this.$Footer.setStyle("display",null)}if(this.getButtonBar().count()){this.$Buttons.setStyle("display",null)}else{this.$Buttons.setStyle("display","none")}if(this.isOpen()===false){this.fireEvent("resize",[this]);return this}if(this.getAttribute("styles")&&this.getAttribute("styles").height){this.setAttribute("height",this.getAttribute("styles").height)}var content_height=this.getAttribute("height"),overflow="auto";if(content_height.toString().match("%")){var Parent=this.$Elm.getParent()||document.body;content_height=content_height.toInt();content_height=Parent.getSize().y*(content_height/100)}content_height=content_height;if(this.getAttribute("breadcrumb")){content_height=content_height}content_height=content_height-this.$Buttons.getSize().y-2-this.$Footer.getSize().y-1-this.$Header.getSize().y;if(this.getAttribute("scrollbars")===false){overflow="hidden"}this.$Content.setStyles({overflow:overflow,height:content_height});this.$Elm.setStyle("height",this.getAttribute("height"));if(this.$ButtonBar){this.$ButtonBar.resize()}this.fireEvent("resize",[this]);return this},open:function(){this.$Content.setStyle("display",null);this.$Elm.setStyle("height",this.getAttribute("height"));if(this.$Collaps){this.$Collaps.removeClass("qui-panel-expand");this.$Collaps.removeClass("icon-chevron-right");this.$Collaps.addClass("qui-panel-collapse");this.$Collaps.addClass("icon-chevron-down")}this.fireEvent("open",[this]);this.resize();return this},minimize:function(){this.$Content.setStyle("display","none");this.$Footer.setStyle("display","none");this.$Buttons.setStyle("display","none");this.$Elm.setStyle("height",this.$Header.getSize().y);this.$Collaps.removeClass("qui-panel-collapse");this.$Collaps.removeClass("icon-chevron-down");this.$Collaps.addClass("qui-panel-expand");this.$Collaps.addClass("icon-chevron-right");this.fireEvent("minimize",[this]);return this},toggle:function(){if(this.getAttribute("collapsible")===false){return this}if(this.isOpen()){this.minimize()}else{this.open()}return this},isOpen:function(){return this.$Content.getStyle("display")=="none"?false:true},highlight:function(){if(!this.getElm()){return this}new Element("div.qui-panel-highlight").inject(this.getElm());return this},normalize:function(){if(!this.getElm()){return this}this.getElm().getElements(".qui-panel-highlight").destroy();return this},getBody:function(){return this.getContent()},getContent:function(){return this.$Content},setContent:function(content){this.$Content.set("html",content);return this},getFooter:function(){return this.$Footer},setFooter:function(content){this.$Footer.set("html",content);return this},getHeader:function(){return this.$Header},addButton:function(Btn){if(!QUI.Controls.isControl(Btn)){if(Btn.type=="seperator"||Btn.type=="qui/controls/buttons/Seperator"){Btn=new Seperator(Btn)}else{Btn=new Button(Btn)}}this.getButtonBar().appendChild(Btn);if(this.getButtonBar().count()==1){this.resize()}return this},getButtons:function(name){if(!this.$ButtonBar){return[]}return this.$ButtonBar.getChildren(name)},getButtonBar:function(){if(!this.$ButtonBar){this.$Buttons.setStyle("display",null);this.$ButtonBar=new Toolbar({slide:false,type:"buttons","menu-button":false}).inject(this.$Buttons)}return this.$ButtonBar},addCategory:function(Btn){if(typeof Btn.getType==="undefined"){Btn=new Button(Btn)}Btn.addEvents({onClick:function(Btn){if(this.$ActiveCat&&this.$ActiveCat==Btn){return}Btn.setActive()}.bind(this),onActive:function(Btn){if(this.$ActiveCat){this.$ActiveCat.setNormal()}this.$ActiveCat=Btn}.bind(this)});this.getCategoryBar().appendChild(Btn);return this},getCategory:function(name){if(!this.$CategoryBar){return[]}return this.$CategoryBar.getChildren(name)},getCategoryBar:function(){if(!this.$CategoryBar){this.$Categories.setStyle("display",null);this.$CategoryBar=new Toolbar({width:190,slide:false,type:"buttons","menu-button":false,events:{onClear:function(Bar){this.$ActiveCat=null}.bind(this)}}).inject(this.$Categories)}return this.$CategoryBar},getActiveCategory:function(){return this.$ActiveCat},getBreadcrumb:function(){if(!this.$BreadcrumbBar){this.$BreadcrumbBar=new BreadcrumbBar({name:"panel-breadcrumb-"+this.getId()}).inject(this.$Breadcrumb)}return this.$BreadcrumbBar},getContextMenu:function(){if(this.$ContextMenu){return this.$ContextMenu}this.$ContextMenu=new ContextMenu({title:this.getAttribute("title"),events:{blur:function(Menu){Menu.hide()}}});this.$ContextMenu.inject(document.body);return this.$ContextMenu},createSheet:function(){var Sheet=(new PanelSheet).inject(this.$Elm);return Sheet},$getDragable:function(callback){var self=this;if(self.$Dropable){callback(self.$Dropable);return}require(["qui/classes/utils/DragDrop"],function(DragDrop){self.$Dropable=new DragDrop(self.$Header,{dropables:".qui-panel-drop",cssClass:"radius5",styles:{width:100,height:150},events:{onStart:function(Dragable,Element,event){self.fireEvent("dragDropStart",[self,Element,event])},onComplete:function(){self.fireEvent("dragDropComplete",[self])},onDrag:function(Dragable,Element,event){self.fireEvent("drag",[self,event])},onEnter:function(Dragable,Element,Dropable){Dropable.highlight()},onLeave:function(Dragable,Element,Dropable){Dropable.highlight()},onDrop:function(Dragable,Element,Dropable,event){if(!Dropable){return}var quiid=Dropable.get("data-quiid");if(!quiid){return}var Parent=QUI.Controls.getById(quiid);Parent.fireEvent("onDrop",[self])}}});callback(self.$Dropable)})},$onSetAttribute:function(attr,value){if(attr=="dragable"){var self=this;self.$getDragable(function(Dragable){if(self.getAttribute("dragable")){Dragable.enable();self.$Header.setStyle("cursor","move");return}Dragable.disable();self.$Header.setStyle("cursor","default")});return}},$onDestroy:function(){if(this.$Elm){this.$Header.destroy()}if(this.$Title){this.$Title.destroy()}if(this.$Footer){this.$Footer.destroy()}if(this.$Content){this.$Content.destroy()}if(this.$Buttons){this.$Buttons.destroy()}if(this.$ButtonBar){this.$ButtonBar.destroy()}if(this.$CategoryBar){this.$CategoryBar.destroy()}if(this.$ActiveCat){this.$ActiveCat.destroy()}if(this.$BreadcrumbBar){this.$BreadcrumbBar.destroy()}if(this.$ContextMenu){this.$ContextMenu.destroy()}}})});
//# sourceMappingURL=/var/www/git/quiqqer/qui/build/qui/controls/desktop/Panel.map.js