define("qui/classes/DOM",[],function(){"use strict";return window.$quistorage={},new Class({Implements:[Options,Events],Type:"qui/classes/DOM",options:{},$uid:null,initialize:function(e){e=e||{},e.events&&(this.addEvents(e.events),delete e.events),e.methods&&(Object.append(this,e.methods),delete e.methods),this.setAttributes(e),this.fireEvent("init",[this])},$family:function(){return"undefined"!=typeof this.Type?this.Type:typeOf(this)},getId:function(){return this.$uid||(this.$uid=String.uniqueID()),this.$uid},getType:function(){return typeOf(this)},setAttribute:function(e,t){if(this.fireEvent("setAttribute",[e,t]),"undefined"!=typeof this.options[e])return void(this.options[e]=t);var s=Slick.uidOf(this);return"undefined"==typeof window.$quistorage[s]&&(window.$quistorage[s]={}),window.$quistorage[s][e]=t,this},destroy:function(){this.fireEvent("destroy",[this]);var e=Slick.uidOf(this);e in window.$quistorage&&delete window.$quistorage[e],this.removeEvents()},setOptions:function(e){this.setAttributes(e)},setAttributes:function(e){e=e||{};for(var t in e)this.setAttribute(t,e[t]);return this},getAttribute:function(e){if(e in this.options)return this.options[e];var t=Slick.uidOf(this);return"undefined"==typeof window.$quistorage[t]?!1:"undefined"!=typeof window.$quistorage[t][e]?window.$quistorage[t][e]:!1},getAllAttributes:function(){return this.getAttributes()},getAttributes:function(){return this.options},getStorageAttributes:function(){var e=Slick.uidOf(this);return e in window.$quistorage?window.$quistorage[e]:{}},existAttribute:function(e){if("undefined"!=typeof this.options[e])return!0;var t=Slick.uidOf(this);return window.$quistorage[t]&&window.$quistorage[t][e]?!0:!1},getEvents:function(e){return"undefined"==typeof this.$events?!1:"undefined"!=typeof this.$events[e]?this.$events[e]:!1}})}),define("qui/classes/Controls",["require","qui/classes/DOM"],function(e,t){"use strict";return new Class({Extends:t,Type:"qui/classes/Controls",initialize:function(){this.$controls={},this.$cids={},this.$types={}},get:function(e){return"undefined"==typeof this.$controls[e]?[]:this.$controls[e]},getById:function(e){return e in this.$cids?this.$cids[e]:!1},getByType:function(e){return e in this.$types?this.$types[e]:[]},loadType:function(t,s){t.match(/qui\//)||(t="qui/"+t),e([modul],s)},isControl:function(e){return"undefined"!=typeof e&&e&&"undefined"!=typeof e.getType?!0:!1},add:function(e){var t=this,s=e.getAttribute("name"),n=typeOf(e);s&&""!==s||(s="#unknown"),"undefined"==typeof this.$controls[s]&&(this.$controls[s]=[]),"undefined"==typeof this.$types[n]&&(this.$types[n]=[]),this.$controls[s].push(e),this.$types[n].push(e),this.$cids[e.getId()]=e,e.addEvent("onDestroy",function(){t.destroy(e)})},destroy:function(e){var t=e.getAttribute("name"),s=typeOf(e),n=e.getId();t&&""!==t||(t="#unknown"),"undefined"!=typeof this.$cids[n]&&delete this.$cids[n];var i,o,r=[];if("undefined"!=typeof this.$controls[t]){for(i=0,o=this.$controls[t].length;o>i;i++)n!==this.$controls[t][i].getId()&&r.push(this.$controls[t][i]);this.$controls[t]=r,r.length||delete this.$controls[t]}if(r=[],"undefined"!=typeof this.$types[s])for(i=0,o=this.$types[s].length;o>i;i++)n!==this.$types[s][i].getId()&&r.push(this.$types[s][i]);this.$types[s]=r}})}),define("qui/classes/QUI",["require","qui/classes/DOM","qui/classes/Controls"],function(e,t,s){"use strict";return new Class({Extends:t,Type:"qui/classes/QUI",initialize:function(t){this.setAttributes({debug:!1,fetchErrors:!0}),this.parent(t),this.getAttribute("fetchErrors")&&(e.onError=function(e,t){self.trigger("ERROR :"+e+"\nRequire :"+t)},window.onerror=this.trigger.bind(this)),this.Controls=new s,this.MessageHandler=null},namespace:function(){for(var e,t=arguments,s=this,n=0,i=0,o=t.length,r=null,a=null;o>n;n+=1)for(r=t[n].split("."),e=r.length,i=0;e>i;i+=1)a=r[i],s[a]=s[a]||{},s=s[a];return s},parse:function(t,s){"undefined"==typeof t&&(t=document.body);var n=t.getElements("[data-qui]"),i=n.map(function(e){return e.get("data-qui")});e(i,function(){var e,t,o,r;for(e=0,t=i.length;t>e;e++)o=arguments[e],r=n[e],r.get("data-quiid")||(""!==r.get("html").trim()?(new o).import(r):(new o).replaces(r));"undefined"!=typeof s&&s()})},triggerError:function(e){return this.trigger(e.getMessage()),this},trigger:function(e,t,s){return this.fireEvent("error",[e,t,s]),this},getMessageHandler:function(t){if("undefined"!=typeof this.$execGetMessageHandler&&!this.MessageHandler)return this.$execGetMessageHandler=!0,void function(){this.getMessageHandler(t)}.delay(20,this);if(this.$execGetMessageHandler=!0,this.MessageHandler)return void t(this.MessageHandler);var s=this;e(["qui/controls/messages/Handler"],function(e){s.MessageHandler=new e,t(s.MessageHandler)})},getControls:function(e){return this.Controls?void e(this.Controls):void 0}})}),define("qui/QUI",["qui/classes/QUI"],function(e){"use strict";return"undefined"==typeof window.QUI&&(window.QUI=new e),document.fireEvent("qui-loaded"),document.addEvent("domready",function(){QUI.parse(document.body)}),window.QUI}),define("qui/classes/Locale",["qui/classes/DOM"],function(e){"use strict";return new Class({Extends:e,Type:"qui/classes/Locale",current:"en",langs:{},no_translation:!1,initialize:function(e){this.parent(e)},setCurrent:function(e){this.current=e},getCurrent:function(){return this.current},set:function(e,t,s,n){if(this.langs[e]||(this.langs[e]={}),this.langs[e][t]||(this.langs[e][t]={}),"undefined"!=typeof n)return this.langs[e][set][s]=n,this;var i=this.langs[e][t];for(var o in s)i[o]=s[o];this.langs[e][t]=i},get:function(e,t,s){if("undefined"==typeof s)return this.$get(e,t);var n=this.$get(e,t);for(e in s)n=n.replace("["+e+"]",s[e]);return n},$get:function(e,t){return this.no_translation?"["+e+"] "+t:this.langs[this.current]&&this.langs[this.current][e]&&this.langs[this.current][e][t]?this.langs[this.current][e][t]:this.langs[this.current]&&this.langs[this.current][e]&&"undefined"==typeof t?this.langs[this.current][e]:(this.fireEvent("error",["No translation found for ["+e+"] "+t,this]),"["+e+"] "+t)}})}),define("qui/Locale",["qui/classes/Locale"],function(e){"use strict";return"undefined"==typeof window.QUILocale&&(window.QUILocale=new e),window.QUILocale}),define("qui/lib/require-css/normalize",[],function(){function e(e,n,i){if(e.match(a)||e.match(r))return e;e=o(e);var l=i.match(r),u=n.match(r);return!u||l&&l[1]==u[1]&&l[2]==u[2]?s(t(e,n),i):t(e,n)}function t(e,t){if("./"==e.substr(0,2)&&(e=e.substr(2)),e.match(a)||e.match(r))return e;var s=t.split("/"),n=e.split("/");for(s.pop();curPart=n.shift();)".."==curPart?s.pop():s.push(curPart);return s.join("/")}function s(e,t){var s=t.split("/");for(s.pop(),t=s.join("/")+"/",i=0;t.substr(i,1)==e.substr(i,1);)i++;for(;"/"!=t.substr(i,1);)i--;t=t.substr(i+1),e=e.substr(i+1),s=t.split("/");var n=e.split("/");for(out="";s.shift();)out+="../";for(;curPart=n.shift();)out+=curPart+"/";return out.substr(0,out.length-1)}var n=/([^:])\/+/g,o=function(e){return e.replace(n,"$1/")},r=/[^\:\/]*:\/\/([^\/])*/,a=/^(\/|data:)/,l=function(t,s,n){s=o(s),n=o(n);for(var i,r,t,a=/@import\s*("([^"]*)"|'([^']*)')|url\s*\(\s*(\s*"([^"]*)"|'([^']*)'|[^\)]*\s*)\s*\)/gi;i=a.exec(t);){r=i[3]||i[2]||i[5]||i[6]||i[4];var l;l=e(r,s,n);var u=i[5]||i[6]?1:0;t=t.substr(0,a.lastIndex-r.length-u-1)+l+t.substr(a.lastIndex-u-1),a.lastIndex=a.lastIndex+(l.length-r.length)}return t};return l.convertURIBase=e,l.absoluteURI=t,l.relativeURI=s,l}),define("qui/lib/require-css/css",[],function(){if("undefined"==typeof window)return{load:function(e,t,s){s()}};var e=document.getElementsByTagName("head")[0],t=window.navigator.userAgent.match(/Trident\/([^ ;]*)|AppleWebKit\/([^ ;]*)|Opera\/([^ ;]*)|rv\:([^ ;]*)(.*?)Gecko\/([^ ;]*)|MSIE\s([^ ;]*)/)||0,s=!1,n=!0;t[1]||t[7]?s=parseInt(t[1])<6||parseInt(t[7])<=9:t[2]?n=!1:t[4]&&(s=parseInt(t[4])<18);var i={};i.pluginBuilder="./css-builder";var o,r,a,l=function(){o=document.createElement("style"),e.appendChild(o),r=o.styleSheet||o.sheet},u=0,c=[],d=function(e){u++,32==u&&(l(),u=0),r.addImport(e),o.onload=h},h=function(){a();var e=c.shift();return e?(a=e[1],void d(e[0])):void(a=null)},f=function(e,t){if(r&&r.addImport||l(),r&&r.addImport)a?c.push([e,t]):(d(e),a=t);else{o.textContent='@import "'+e+'";';var s=setInterval(function(){try{o.sheet.cssRules,clearInterval(s),t()}catch(e){}},10)}},g=function(t,s){var i=document.createElement("link");if(i.type="text/css",i.rel="stylesheet",n)i.onload=function(){i.onload=function(){},setTimeout(s,7)};else var o=setInterval(function(){for(var e=0;e<document.styleSheets.length;e++){var t=document.styleSheets[e];if(t.href==i.href)return clearInterval(o),s()}},10);i.href=t,e.appendChild(i)};return i.normalize=function(e,t){return".css"==e.substr(e.length-4,4)&&(e=e.substr(0,e.length-4)),t(e)},i.load=function(e,t,n){(s?f:g)(t.toUrl(e+".css"),n)},i}),define("qui/lib/require-css/css!qui/controls/Control",[],function(){}),define("qui/controls/Control",["qui/QUI","qui/Locale","qui/classes/DOM","css!qui/controls/Control.css"],function(e,t,s){"use strict";return new Class({Extends:s,Type:"qui/controls/Control",$Parent:null,options:{name:""},initialize:function(t){this.parent(t),this.addEvent("onDestroy",function(){"undefined"!=typeof this.$Elm&&this.$Elm&&this.$Elm.destroy(),this.$Elm=null}.bind(this)),e.Controls.add(this)},create:function(){return this.$Elm?this.$Elm:(this.$Elm=new Element("div.qui-control"),this.$Elm.set("data-quiid",this.getId()),this.$Elm)},inject:function(t,s){return this.fireEvent("drawBegin",[this]),"undefined"!=typeof this.$Elm&&this.$Elm||(this.$Elm=this.create()),"undefined"!=typeof e&&"undefined"!=typeof e.Controls&&e.Controls.isControl(t)?t.appendChild(this):this.$Elm.inject(t,s),this.$Elm.set("data-quiid",this.getId()),this.fireEvent("inject",[this]),this},"import":function(e){return this.$Elm=e,this.fireEvent("import",[this,e]),this},replaces:function(e){return this.$Elm?this.$Elm:("styles"in e&&this.setAttribute("styles",e.styles),this.$Elm=this.create(),this.$Elm.set("data-quiid",this.getId()),this.$Elm.set("data-qui",e.get("data-qui")),e.getParent()&&this.$Elm.replaces(e),this)},serialize:function(){return{attributes:this.getAttributes(),type:this.getType()}},unserialize:function(e){e.attributes&&this.setAttributes(e.attributes)},getElm:function(){return"undefined"!=typeof this.$Elm&&this.$Elm||this.create(),this.$Elm},getParent:function(){return this.$Parent||!1},setParent:function(e){return this.$Parent=e,this},getPath:function(){var e="/"+this.getAttribute("name"),t=this.getParent();return t?t.getPath()+e:e},hide:function(){return this.$Elm&&this.$Elm.setStyle("display","none"),this},show:function(){return this.$Elm&&this.$Elm.setStyle("display",null),this},highlight:function(){return this.fireEvent("highlight",[this]),this},normalize:function(){return this.fireEvent("normalize",[this]),this},focus:function(){if(this.$Elm)try{this.$Elm.focus()}catch(e){}return this},resize:function(){this.fireEvent("resize",[this])},openSheet:function(e){var s=new Element("div",{"class":"qui-sheet qui-box",html:'<div class="qui-sheet-content box"></div><div class="qui-sheet-buttons box"><div class="qui-sheet-buttons-back qui-button btn-white"><span>'+t.get("qui/controls/Control","btn.back")+"</span></div></div>",styles:{left:"-110%"}}).inject(this.$Elm);s.getElement(".qui-sheet-buttons-back").addEvent("click",function(){s.fireEvent("close")}),s.addEvent("close",function(){moofx(s).animate({left:"-100%"},{callback:function(){s.destroy()}})});var n=s.getElement(".qui-sheet-content");return n.setStyles({height:s.getSize().y-80}),moofx(s).animate({left:0},{callback:function(){e(n,s)}}),s}})}),function(){var e=function(e){"use strict";function t(e){if(e.paused||e.ended||y)return!1;try{c.clearRect(0,0,l,a),c.drawImage(e,0,0,l,a)}catch(s){}w=setTimeout(t,k.duration,e),T.setIcon(u)}function s(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,function(e,t,s,n){return t+t+s+s+n+n});var s=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return s?{r:parseInt(s[1],16),g:parseInt(s[2],16),b:parseInt(s[3],16)}:!1}function n(e,t){var s,n={};for(s in e)n[s]=e[s];for(s in t)n[s]=t[s];return n}function i(){return document.hidden||document.msHidden||document.webkitHidden||document.mozHidden}e=e?e:{};var o,r,a,l,u,c,d,h,f,g,m,y,p,v,w,b={bgColor:"#d00",textColor:"#fff",fontFamily:"sans-serif",fontStyle:"bold",type:"circle",position:"down",animation:"slide",elementId:!1};p={},p.ff=/firefox/i.test(navigator.userAgent.toLowerCase()),p.chrome=/chrome/i.test(navigator.userAgent.toLowerCase()),p.opera=/opera/i.test(navigator.userAgent.toLowerCase()),p.ie=/msie/i.test(navigator.userAgent.toLowerCase())||/trident/i.test(navigator.userAgent.toLowerCase()),p.supported=p.chrome||p.ff||p.opera;var E=[];m=function(){},h=y=!1;var $=function(){o=n(b,e),o.bgColor=s(o.bgColor),o.textColor=s(o.textColor),o.position=o.position.toLowerCase(),o.animation=k.types[""+o.animation]?o.animation:b.animation;var t=o.position.indexOf("up")>-1,i=o.position.indexOf("left")>-1;if(t||i)for(var h=0;h<k.types[""+o.animation].length;h++){var f=k.types[""+o.animation][h];t&&(f.y=f.y<.6?f.y-.4:f.y-2*f.y+(1-f.w)),i&&(f.x=f.x<.6?f.x-.4:f.x-2*f.x+(1-f.h)),k.types[""+o.animation][h]=f}o.type=q[""+o.type]?o.type:b.type;try{r=T.getIcon(),u=document.createElement("canvas"),d=document.createElement("img"),r.hasAttribute("href")?(d.setAttribute("src",r.getAttribute("href")),d.onload=function(){a=d.height>0?d.height:32,l=d.width>0?d.width:32,u.height=a,u.width=l,c=u.getContext("2d"),x.ready()}):(d.setAttribute("src",""),a=32,l=32,d.height=a,d.width=l,u.height=a,u.width=l,c=u.getContext("2d"),x.ready())}catch(g){throw"Error initializing favico. Message: "+g.message}},x={};x.ready=function(){h=!0,x.reset(),m()},x.reset=function(){h&&(E=[],f=!1,c.clearRect(0,0,l,a),c.drawImage(d,0,0,l,a),T.setIcon(u),window.clearTimeout(v),window.clearTimeout(w))},x.start=function(){if(h&&!g){var e=function(){f=E[0],g=!1,E.length>0&&(E.shift(),x.start())};if(E.length>0){g=!0;var t=function(){["type","animation","bgColor","textColor","fontFamily","fontStyle"].forEach(function(e){e in E[0].options&&(o[e]=E[0].options[e])}),k.run(E[0].options,function(){e()},!1)};f?k.run(f.options,function(){t()},!0):t()}}};var q={},I=function(e){return e.n="number"==typeof e.n?Math.abs(0|e.n):e.n,e.x=l*e.x,e.y=a*e.y,e.w=l*e.w,e.h=a*e.h,e.len=(""+e.n).length,e};q.circle=function(e){e=I(e);var t=!1;2===e.len?(e.x=e.x-.4*e.w,e.w=1.4*e.w,t=!0):e.len>=3&&(e.x=e.x-.65*e.w,e.w=1.65*e.w,t=!0),c.clearRect(0,0,l,a),c.drawImage(d,0,0,l,a),c.beginPath(),c.font=o.fontStyle+" "+Math.floor(e.h*(e.n>99?.85:1))+"px "+o.fontFamily,c.textAlign="center",t?(c.moveTo(e.x+e.w/2,e.y),c.lineTo(e.x+e.w-e.h/2,e.y),c.quadraticCurveTo(e.x+e.w,e.y,e.x+e.w,e.y+e.h/2),c.lineTo(e.x+e.w,e.y+e.h-e.h/2),c.quadraticCurveTo(e.x+e.w,e.y+e.h,e.x+e.w-e.h/2,e.y+e.h),c.lineTo(e.x+e.h/2,e.y+e.h),c.quadraticCurveTo(e.x,e.y+e.h,e.x,e.y+e.h-e.h/2),c.lineTo(e.x,e.y+e.h/2),c.quadraticCurveTo(e.x,e.y,e.x+e.h/2,e.y)):c.arc(e.x+e.w/2,e.y+e.h/2,e.h/2,0,2*Math.PI),c.fillStyle="rgba("+o.bgColor.r+","+o.bgColor.g+","+o.bgColor.b+","+e.o+")",c.fill(),c.closePath(),c.beginPath(),c.stroke(),c.fillStyle="rgba("+o.textColor.r+","+o.textColor.g+","+o.textColor.b+","+e.o+")","number"==typeof e.n&&e.n>999?c.fillText((e.n>9999?9:Math.floor(e.n/1e3))+"k+",Math.floor(e.x+e.w/2),Math.floor(e.y+e.h-.2*e.h)):c.fillText(e.n,Math.floor(e.x+e.w/2),Math.floor(e.y+e.h-.15*e.h)),c.closePath()},q.rectangle=function(e){e=I(e);var t=!1;2===e.len?(e.x=e.x-.4*e.w,e.w=1.4*e.w,t=!0):e.len>=3&&(e.x=e.x-.65*e.w,e.w=1.65*e.w,t=!0),c.clearRect(0,0,l,a),c.drawImage(d,0,0,l,a),c.beginPath(),c.font="bold "+Math.floor(e.h*(e.n>99?.9:1))+"px sans-serif",c.textAlign="center",c.fillStyle="rgba("+o.bgColor.r+","+o.bgColor.g+","+o.bgColor.b+","+e.o+")",c.fillRect(e.x,e.y,e.w,e.h),c.fillStyle="rgba("+o.textColor.r+","+o.textColor.g+","+o.textColor.b+","+e.o+")","number"==typeof e.n&&e.len>3?c.fillText((e.n>9999?9:Math.floor(e.n/1e3))+"k+",Math.floor(e.x+e.w/2),Math.floor(e.y+e.h-.2*e.h)):c.fillText(e.n,Math.floor(e.x+e.w/2),Math.floor(e.y+e.h-.15*e.h)),c.closePath()};var C=function(e,t){t=("string"==typeof t?{animation:t}:t)||{},m=function(){try{if("number"==typeof e?e>0:""!==e){var n={type:"badge",options:{n:e}};if("animation"in t&&k.types[""+t.animation]&&(n.options.animation=""+t.animation),"type"in t&&q[""+t.type]&&(n.options.type=""+t.type),["bgColor","textColor"].forEach(function(e){e in t&&(n.options[e]=s(t[e]))}),["fontStyle","fontFamily"].forEach(function(e){e in t&&(n.options[e]=t[e])}),E.push(n),E.length>100)throw"Too many badges requests in queue.";x.start()}else x.reset()}catch(i){throw"Error setting badge. Message: "+i.message}},h&&m()},M=function(e){m=function(){try{var t=e.width,s=e.height,n=document.createElement("img"),i=s/a>t/l?t/l:s/a;n.setAttribute("src",e.getAttribute("src")),n.height=s/i,n.width=t/i,c.clearRect(0,0,l,a),c.drawImage(n,0,0,l,a),T.setIcon(u)}catch(o){throw"Error setting image. Message: "+o.message}},h&&m()},A=function(e){m=function(){try{if("stop"===e)return y=!0,x.reset(),void(y=!1);e.addEventListener("play",function(){t(this)},!1)}catch(s){throw"Error setting video. Message: "+s.message}},h&&m()},S=function(e){if(window.URL&&window.URL.createObjectURL||(window.URL=window.URL||{},window.URL.createObjectURL=function(e){return e}),p.supported){var s=!1;navigator.getUserMedia=navigator.getUserMedia||navigator.oGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia||navigator.webkitGetUserMedia,m=function(){try{if("stop"===e)return y=!0,x.reset(),void(y=!1);s=document.createElement("video"),s.width=l,s.height=a,navigator.getUserMedia({video:!0,audio:!1},function(e){s.src=URL.createObjectURL(e),s.play(),t(s)},function(){})}catch(n){throw"Error setting webcam. Message: "+n.message}},h&&m()}},T={};T.getIcon=function(){var e=!1,t="",s=function(){for(var e=document.getElementsByTagName("head")[0].getElementsByTagName("link"),t=e.length,s=t-1;s>=0;s--)if(/(^|\s)icon(\s|$)/i.test(e[s].getAttribute("rel")))return e[s];return!1};if(o.elementId?(e=document.getElementById(o.elementId),e.setAttribute("href",e.getAttribute("src"))):(e=s(),e===!1&&(e=document.createElement("link"),e.setAttribute("rel","icon"),document.getElementsByTagName("head")[0].appendChild(e))),t=o.elementId?e.src:e.href,-1===t.indexOf(document.location.hostname))throw new Error("Error setting favicon. Favicon image is on different domain (Icon: "+t+", Domain: "+document.location.hostname+")");return e.setAttribute("type","image/png"),e},T.setIcon=function(e){var t=e.toDataURL("image/png");if(o.elementId)document.getElementById(o.elementId).setAttribute("src",t);else if(p.ff||p.opera){var s=r;r=document.createElement("link"),p.opera&&r.setAttribute("rel","icon"),r.setAttribute("rel","icon"),r.setAttribute("type","image/png"),document.getElementsByTagName("head")[0].appendChild(r),r.setAttribute("href",t),s.parentNode&&s.parentNode.removeChild(s)}else r.setAttribute("href",t)};var k={};return k.duration=40,k.types={},k.types.fade=[{x:.4,y:.4,w:.6,h:.6,o:0},{x:.4,y:.4,w:.6,h:.6,o:.1},{x:.4,y:.4,w:.6,h:.6,o:.2},{x:.4,y:.4,w:.6,h:.6,o:.3},{x:.4,y:.4,w:.6,h:.6,o:.4},{x:.4,y:.4,w:.6,h:.6,o:.5},{x:.4,y:.4,w:.6,h:.6,o:.6},{x:.4,y:.4,w:.6,h:.6,o:.7},{x:.4,y:.4,w:.6,h:.6,o:.8},{x:.4,y:.4,w:.6,h:.6,o:.9},{x:.4,y:.4,w:.6,h:.6,o:1}],k.types.none=[{x:.4,y:.4,w:.6,h:.6,o:1}],k.types.pop=[{x:1,y:1,w:0,h:0,o:1},{x:.9,y:.9,w:.1,h:.1,o:1},{x:.8,y:.8,w:.2,h:.2,o:1},{x:.7,y:.7,w:.3,h:.3,o:1},{x:.6,y:.6,w:.4,h:.4,o:1},{x:.5,y:.5,w:.5,h:.5,o:1},{x:.4,y:.4,w:.6,h:.6,o:1}],k.types.popFade=[{x:.75,y:.75,w:0,h:0,o:0},{x:.65,y:.65,w:.1,h:.1,o:.2},{x:.6,y:.6,w:.2,h:.2,o:.4},{x:.55,y:.55,w:.3,h:.3,o:.6},{x:.5,y:.5,w:.4,h:.4,o:.8},{x:.45,y:.45,w:.5,h:.5,o:.9},{x:.4,y:.4,w:.6,h:.6,o:1}],k.types.slide=[{x:.4,y:1,w:.6,h:.6,o:1},{x:.4,y:.9,w:.6,h:.6,o:1},{x:.4,y:.9,w:.6,h:.6,o:1},{x:.4,y:.8,w:.6,h:.6,o:1},{x:.4,y:.7,w:.6,h:.6,o:1},{x:.4,y:.6,w:.6,h:.6,o:1},{x:.4,y:.5,w:.6,h:.6,o:1},{x:.4,y:.4,w:.6,h:.6,o:1}],k.run=function(e,t,s,r){var a=k.types[i()?"none":o.animation];return r=s===!0?"undefined"!=typeof r?r:a.length-1:"undefined"!=typeof r?r:0,t=t?t:function(){},r<a.length&&r>=0?(q[o.type](n(e,a[r])),v=setTimeout(function(){s?r-=1:r+=1,k.run(e,t,s,r)},k.duration),T.setIcon(u),void 0):void t()},$(),{badge:C,video:A,image:M,webcam:S,reset:x.reset}};"undefined"!=typeof define&&define.amd?define("qui/controls/messages/Favico",[],function(){return e}):"undefined"!=typeof module&&module.exports?module.exports=e:this.Favico=e}();var needle=["qui/classes/DOM"];("undefined"==typeof window.localStorage||"undefined"==typeof window.sessionStorage)&&needle.push("qui/classes/storage/Polyfill"),define(needle,function(e){"use strict";return new Class({Extends:e,Type:"qui/classes/storage/Storage",set:function(e,t){window.localStorage.setItem(e,t)},get:function(e){return window.localStorage.getItem(e)}})}),define("qui/classes/storage/Storage",function(){}),define("qui/lib/require-css/css!qui/controls/messages/Handler",[],function(){}),define("qui/controls/messages/Handler",["require","qui/controls/Control","qui/controls/messages/Favico","qui/Locale","qui/classes/storage/Storage","css!qui/controls/messages/Handler.css"],function(e,t,s,n){"use strict";return new Class({Extends:t,Type:"qui/controls/messages/Handler",$messages:[],$newMessages:0,$filter:{attention:!0,error:!0,information:!0,success:!0},options:{autosave:!0,autoload:!0},initialize:function(t){var n=this;if(this.parent(t),this.Favico=null,this.$Parent=null,!Browser.ie||Browser.ie&&Browser.version>9){try{this.Favico=new s({animation:"fade"})}catch(i){}window.addEvent("unload",function(){n.Favico&&n.Favico.badge(0)})}var o=window.localStorage.getItem("messageHandler");o&&(o=JSON.decode(o),o.config&&this.setAttributes(o.config),o.filter&&(this.$filter=Object.merge(this.$filter,o.filter)),o.messages&&(o.messages.sort(function(e,t){return e=new Date(e.time),t=new Date(t.time),e>t?-1:t>e?1:0}),e(["qui/controls/messages/Attention","qui/controls/messages/Error","qui/controls/messages/Information","qui/controls/messages/Success","qui/controls/messages/Message"],function(e,t,s,i,r){var a,l,u,c,d;for(a=0,l=o.messages.length;l>a;a++){switch(c=o.messages[a],u=c.Type,delete c.Type,u){case"qui/controls/messages/Attention":d=new e(c);break;case"qui/controls/messages/Error":d=new t(c);break;case"qui/controls/messages/Information":d=new s(c);break;case"qui/controls/messages/Success":d=new i(c);break;default:d=new r(c)}d.addEvent("onDestroy",n.$onMessageDestroy.bind(n)),n.$messages.push(d)}})),o.newMessages&&n.$messages.length&&(this.$newMessages=o.newMessages,this.refreshFavicon()),this.getAttribute("autoload")&&this.load())},bindParent:function(e){this.$Parent=e},unbindParent:function(){this.$Parent=null},load:function(){if("undefined"!=typeof User&&User){var t=this;e(["qui/controls/messages/Attention","qui/controls/messages/Error","qui/controls/messages/Information","qui/controls/messages/Success"],function(e,s,n,i){_Ajax.asyncPost("ajax_messages_get",function(o){var r,a,l,u,c;for(r=0,a=o.length;a>r;r++){switch(u=o[r],l={message:u.message,time:u.time},u.mtype){case"QUI\\Messages\\Attention":c=new e(l);break;case"QUI\\Messages\\Error":c=new s(l);break;case"QUI\\Messages\\Information":c=new n(l);break;case"QUI\\Messages\\Success":c=new i(l);break;default:continue}t.add(c)}}),t.fireEvent("load",[t])})}},create:function(){return this.$Elm=new Element("div",{"class":"message-handler-control",html:'<span class="icon-info"></span><span class="message-handler-count"></span>',title:n.get("qui/controls/messages","handler.open"),events:{click:this.open.bind(this)}}),this.refreshFavicon(),this.$Elm},open:function(){if(!document.getElement(".message-handler-container")){this.$newMessages=0;var e=this.$Parent;this.$Parent||(e=document.body);var t=this,s=(e.getSize(),new Element("div",{"class":"message-handler-container",html:'<div class="message-handler-container-title">Nachrichten</div><div class="message-handler-container-buttons"><div class="success message-handler-container-button grid-20 mobile-grid-20 icon-ok"></div><div class="information message-handler-container-button grid-20 mobile-grid-20 icon-info-sign"></div><div class="attention message-handler-container-button grid-20 mobile-grid-20 icon-warning-sign"></div><div class="error message-handler-container-button grid-20 mobile-grid-20 icon-bolt"></div><div class="trash message-handler-container-button grid-20 mobile-grid-20 icon-trash"></div></div><div class="message-handler-container-messages"></div><div class="message-handler-container-close"></div>'}).inject(e));s.getElement(".icon-trash").addEvent("click",this.clear.bind(this)),e!=document.body&&(s.setStyles({border:"none",position:"relative"}),s.getElement(".message-handler-container-title").destroy(),s.getElement(".message-handler-container-close").setStyle("display","none"));var i=s.getElements(".success,.information,.attention,.error");i.addEvent("click",this.$switchFilterStatus.bind(this)),i.addClass("message-handler-container-buttons-active"),s.getElement(".trash").set({title:n.get("qui/controls/messages","handler.button.clear")}),s.getElement(".success").set({title:n.get("qui/controls/messages","handler.button.success")}),s.getElement(".information").set({title:n.get("qui/controls/messages","handler.button.information")}),s.getElement(".attention").set({title:n.get("qui/controls/messages","handler.button.attention")}),s.getElement(".error").set({title:n.get("qui/controls/messages","handler.button.error")});var o=s.getElement(".message-handler-container-messages"),r=s.getElement(".message-handler-container-close");new Element("div",{"class":"button message-handler-container-close-btn",html:n.get("qui/controls/messages","handler.button.close"),events:{click:function(){t.close()}}}).inject(r),this.$onResize(),window.addEvent("resize",this.$onResize),moofx(s).animate({left:0},{callback:function(){o.set("html",""),t.$messages.sort(function(e,t){return e=new Date(e.getAttribute("time")),t=new Date(t.getAttribute("time")),e>t?-1:t>e?1:0});for(var i=0,r=t.$messages.length;r>i;i++)t.$messages[i].inject(o);r||o.set("html",'<p style="text-align: center;">'+n.get("qui/controls/messages","handler.no.messages")+"</p>"),e==document.body&&s.addClass("shadow"),t.refreshFavicon(),t.save()}})}},parse:function(t,s){e(["qui/controls/messages/Attention","qui/controls/messages/Error","qui/controls/messages/Information","qui/controls/messages/Success","qui/controls/messages/Message"],function(e,n,i,o,r){var a,l;switch(a={message:t.message,time:t.time},t.mtype){case"QUI\\Messages\\Attention":l=new e(a);break;case"QUI\\Messages\\Error":l=new n(a);break;case"QUI\\Messages\\Information":l=new i(a);break;case"QUI\\Messages\\Success":l=new o(a);break;default:l=new r(a)}s(l)})},close:function(){var e=this,t=document.getElement(".message-handler-container");t.removeClass("shadow"),moofx(t).animate({left:-500},{callback:function(){t.destroy(),document.removeEvent("onResize",e.$onResize)}})},clear:function(){this.$messages=[];var e=document.getElement(".message-handler-container-messages");e&&e.set("html",'<p style="text-align: center;">'+n.get("qui/controls/messages","handler.no.messages")+"</p>"),this.Favico&&this.Favico.reset(),this.fireEvent("clear",[this]),this.getAttribute("autosave")&&this.save()},count:function(){return this.$messages.length},save:function(){var e,t,s,n=[],i={config:this.getAttributes(),filter:this.$filter,newMessages:this.$newMessages};for(e=0,t=this.$messages.length;t>e;e++)s=this.$messages[e].getAttributes(),s.Type=this.$messages[e].getType(),n.push(s);i.messages=n,window.localStorage.setItem("messageHandler",JSON.encode(i))},filter:function(){var e=document.getElement(".message-handler-container");if(e){var t,s,n,i=e.getElements(".messages-message"),o=this.$filter;for(t=0,s=i.length;s>t;t++)n=i[t],o.attention&&n.hasClass("message-attention")?n.setStyle("display",null):o.error&&n.hasClass("message-error")?n.setStyle("display",null):o.information&&n.hasClass("message-information")?n.setStyle("display",null):o.success&&n.hasClass("message-success")?n.setStyle("display",null):n.setStyle("display","none")}},getNewMessages:function(){return this.$newMessages},getMessages:function(){return this.$messages},refreshFavicon:function(){if(this.Favico&&this.Favico.badge(this.$newMessages),this.getElm()){var e=this.getElm().getElement(".message-handler-count");e&&e.set({html:this.$newMessages,styles:{display:this.$newMessages?"inline":"none"}})}},add:function(e,t){var s=document.getElement(".message-handler-container-messages");if(this.$messages.push(e),e.addEvent("onDestroy",this.$onMessageDestroy.bind(this)),!s){this.$newMessages++,this.refreshFavicon(),this.getAttribute("autosave")&&this.save();var n,i,o=e.createMessageElement();return"undefined"==typeof t&&(t=document.body),n=t.getPosition(),i=t.getSize(),o.setStyles({left:n.x,position:"absolute",top:n.y+i.y,width:280,zIndex:1e4}),t==document.body&&o.setStyles({bottom:10,left:10,position:"fixed",top:null}),o.addClass("animated"),o.inject(document.body),o.addClass("fadeInDown"),function(){moofx(o).animate({opacity:0},{callback:function(){o.destroy()}})}.delay(2e3),this.fireEvent("add",[this,e]),this}return 1==this.$messages.length&&s.set("html",""),e.inject(s,"top"),new Fx.Scroll(s).toTop(),e.getElm().addClass("animated"),e.getElm().addClass("flash"),this.getAttribute("autosave")&&this.save(),this.fireEvent("add",[this,e]),this},addAttention:function(t,s){var n=this;return e(["qui/controls/messages/Attention"],function(e){var i=new e({message:t});n.add(i,s),n.fireEvent("addAttention",[this,i])}),this},addError:function(t,s){var n=this;return e(["qui/controls/messages/Error"],function(e){var i=new e({message:t});n.add(i,s),n.fireEvent("addError",[this,i])}),this},addException:function(t,s){var n=this;return e(["qui/controls/messages/Error"],function(e){var i=new e({message:t.getMessage(),code:t.getCode()});n.add(i,s),n.fireEvent("addError",[this,i])}),this},addInformation:function(t,s){var n=this;return e(["qui/controls/messages/Information"],function(e){var i=new e({message:t});n.add(i,s),n.fireEvent("addInformation",[this,i])}),this},addSuccess:function(t,s){var n=this;return e(["qui/controls/messages/Success"],function(e){var i=new e({message:t});n.add(i,s),n.fireEvent("addSuccess",[this,i])}),this},$switchFilterStatus:function(e){var t=e.target,s=!1,n=t.hasClass("message-handler-container-buttons-active");if(t.hasClass("success"))s="success";else if(t.hasClass("information"))s="information";else if(t.hasClass("attention"))s="attention";else{if(!t.hasClass("error"))return;s="error"}n?t.removeClass("message-handler-container-buttons-active"):t.addClass("message-handler-container-buttons-active"),this.$filter[s]=n?!1:!0,this.filter()},$onMessageDestroy:function(e){var t,s,n=[];for(t=0,s=this.$messages.length;s>t;t++)this.$messages[t]!=e&&n.push(this.$messages[t]);this.$messages=n,this.save()},$onResize:function(){var e=document.getElement(".message-handler-container");if(e){var t,s=this.$Parent;s||(s=document.body);var n=s.getSize(),i=e.getElement(".message-handler-container-title"),o=e.getElement(".message-handler-container-buttons"),r=e.getElement(".message-handler-container-messages"),a=e.getElement(".message-handler-container-close");t=n.y-i.getSize().y-o.getSize().y-a.getSize().y,r.setStyles({height:t})}}})});
//# sourceMappingURL=Handler.js.map